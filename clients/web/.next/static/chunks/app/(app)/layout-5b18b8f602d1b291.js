(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[814],{52226:function(e,o,t){Promise.resolve().then(t.bind(t,32695)),Promise.resolve().then(t.bind(t,63067))},32695:function(e,o,t){"use strict";t.r(o),t.d(o,{Header:function(){return a}});var r=t(89075),n=t(19894),s=t(980);function a(){let{user:e,signOut:o,loading:t}=(0,n.useAuth)();return(0,r.jsxs)("header",{className:"h-16 bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 flex items-center justify-between px-6",children:[(0,r.jsx)("div",{className:"flex items-center gap-4",children:(0,r.jsx)("h1",{className:"text-lg font-semibold text-slate-900 dark:text-white",children:"Welcome back"})}),(0,r.jsx)("div",{className:"flex items-center gap-4",children:t?(0,r.jsx)("span",{className:"text-sm text-slate-500",children:"Loading..."}):e?(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:e.email}),(0,r.jsx)("button",{onClick:()=>o(),className:"text-sm text-slate-600 hover:text-slate-900 dark:text-slate-400 dark:hover:text-white",children:"Sign out"})]}):(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("span",{className:"text-sm text-slate-500",children:"Guest mode"}),(0,r.jsx)(s.default,{href:"/login",className:"text-sm text-brand-600 hover:text-brand-700 font-medium",children:"Sign in"})]})})]})}},63067:function(e,o,t){"use strict";t.r(o),t.d(o,{Sidebar:function(){return i}});var r=t(89075),n=t(980),s=t(65095),a=t(68273);let l=[{name:"Today's Focus",href:"/today",icon:function(e){let{className:o}=e;return(0,r.jsx)("svg",{className:o,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})})}},{name:"Path Progress",href:"/path",icon:function(e){let{className:o}=e;return(0,r.jsx)("svg",{className:o,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})})}},{name:"Mastery",href:"/mastery",icon:function(e){let{className:o}=e;return(0,r.jsx)("svg",{className:o,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}},{name:"Reviews",href:"/reviews",icon:function(e){let{className:o}=e;return(0,r.jsx)("svg",{className:o,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}},{name:"Submissions",href:"/submissions",icon:function(e){let{className:o}=e;return(0,r.jsx)("svg",{className:o,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}},{name:"Coach",href:"/coach",icon:function(e){let{className:o}=e;return(0,r.jsx)("svg",{className:o,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}}];function i(){let e=(0,s.usePathname)();return(0,r.jsxs)("aside",{className:"w-64 bg-white dark:bg-slate-800 border-r border-slate-200 dark:border-slate-700 min-h-screen",children:[(0,r.jsx)("div",{className:"p-6",children:(0,r.jsx)(n.default,{href:"/today",className:"flex items-center gap-2",children:(0,r.jsx)("span",{className:"text-2xl font-bold text-brand-600",children:"LeetLoop"})})}),(0,r.jsx)("nav",{className:"px-4 pb-4",children:(0,r.jsx)("ul",{className:"space-y-1",children:l.map(o=>{let t=e===o.href||e.startsWith("".concat(o.href,"/"));return(0,r.jsx)("li",{children:(0,r.jsxs)(n.default,{href:o.href,className:(0,a.W)("flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium transition-colors",t?"bg-brand-50 text-brand-700 dark:bg-brand-900/20 dark:text-brand-400":"text-slate-600 hover:bg-slate-100 dark:text-slate-400 dark:hover:bg-slate-700/50"),children:[(0,r.jsx)(o.icon,{className:"w-5 h-5"}),o.name]})},o.name)})})})]})}},19894:function(e,o,t){"use strict";t.r(o),t.d(o,{AuthProvider:function(){return h},useAuth:function(){return g}});var r=t(89075),n=t(50511),s=t(52453);let a=null,l=async(e,o,t)=>await t(),i={SESSION_BRIDGE:"leetloop_session_bridge"},c={AUTH_CHANGE:"leetloop:auth-change",SIGNED_OUT:"leetloop:signed-out",GUEST_ID:"leetloop:guest-id"};function u(e){if(console.log("[LeetLoop Web] storeSessionBridge called, hasSession:",!!e),(null==e?void 0:e.access_token)&&(null==e?void 0:e.refresh_token)){let o={access_token:e.access_token,refresh_token:e.refresh_token};localStorage.setItem(i.SESSION_BRIDGE,JSON.stringify(o)),console.log("[LeetLoop Web] Session bridge stored in localStorage"),window.dispatchEvent(new CustomEvent(c.AUTH_CHANGE,{detail:o})),console.log("[LeetLoop Web] Dispatched auth-change event")}else localStorage.removeItem(i.SESSION_BRIDGE)}function d(){localStorage.removeItem(i.SESSION_BRIDGE),window.dispatchEvent(new CustomEvent(c.SIGNED_OUT))}let m=(0,n.createContext)(void 0);function h(e){let{children:o}=e,[t,i]=(0,n.useState)(null),[h,g]=(0,n.useState)(null),[L,x]=(0,n.useState)(!0),v=(0,n.useMemo)(()=>a||(a=(0,s.createBrowserClient)("https://ewezpbczwioxyflyffyy.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImV3ZXpwYmN6d2lveHlmbHlmZnl5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjkzMDI3MzAsImV4cCI6MjA4NDg3ODczMH0.XxVIJRRYNR_IdMhVN0gGMVYghb19Uyly4rbwxJJKDVg",{auth:{flowType:"pkce",detectSessionInUrl:!0,persistSession:!0,debug:!1,lock:l}})),[]),_=(null==t?void 0:t.id)||p();(0,n.useEffect)(()=>{let e=!0,o=null;(async()=>{try{let{data:{session:t}}=await v.auth.getSession();if(e){var o;g(t),i(null!==(o=null==t?void 0:t.user)&&void 0!==o?o:null),x(!1),u(t)}}catch(o){o instanceof Error&&"AbortError"===o.name?console.log("[LeetLoop] Ignoring AbortError in dev mode"):console.error("[LeetLoop] Error getting session:",o),e&&x(!1)}})();let t=p();t&&window.dispatchEvent(new CustomEvent(c.GUEST_ID,{detail:t}));try{let{data:t}=v.auth.onAuthStateChange(async(o,t)=>{if(e){var r;g(t),i(null!==(r=null==t?void 0:t.user)&&void 0!==r?r:null),x(!1),u(t),"SIGNED_IN"===o&&(null==t?void 0:t.user)&&await f(v,t.user.id),"SIGNED_OUT"===o&&d()}});o=t.subscription}catch(e){console.error("[LeetLoop] Error setting up auth listener:",e)}return()=>{e=!1,null==o||o.unsubscribe()}},[v]);let I=async(e,o)=>{let{error:t}=await v.auth.signInWithPassword({email:e,password:o});if(t)throw t},b=async(e,o)=>{let{error:t}=await v.auth.signUp({email:e,password:o});if(t)throw t},k=async()=>{let{error:e}=await v.auth.signInWithOAuth({provider:"google",options:{redirectTo:"".concat(window.location.origin,"/auth/callback")}});if(e)throw e},S=async()=>{let{error:e}=await v.auth.signOut();if(e)throw e;d()};return(0,r.jsx)(m.Provider,{value:{user:t,session:h,userId:_,loading:L,signIn:I,signUp:b,signInWithGoogle:k,signOut:S},children:o})}function g(){let e=(0,n.useContext)(m);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}function p(){let e=localStorage.getItem("leetloop_user_id");return e||(e=crypto.randomUUID(),localStorage.setItem("leetloop_user_id",e)),e}async function f(e,o){if("true"===localStorage.getItem("leetloop_migration_complete")){console.log("[LeetLoop] Migration already marked complete, skipping"),console.log('[LeetLoop] To retry migration, run: localStorage.removeItem("leetloop_migration_complete")');return}let t=localStorage.getItem("leetloop_user_id");if(!t){console.log("[LeetLoop] No guest user ID found, nothing to migrate"),localStorage.setItem("leetloop_migration_complete","true");return}if(t===o){console.log("[LeetLoop] Guest ID matches auth ID, no migration needed"),localStorage.setItem("leetloop_migration_complete","true");return}console.log("[LeetLoop] Starting migration..."),console.log("[LeetLoop] Guest UUID:",t),console.log("[LeetLoop] Auth User ID:",o);try{let{data:r,error:n}=await e.rpc("migrate_guest_to_auth",{p_guest_id:t,p_auth_id:o});if(n){console.error("[LeetLoop] Migration RPC error:",n),console.error("[LeetLoop] Error code:",n.code),console.error("[LeetLoop] Error message:",n.message),console.error("[LeetLoop] Error details:",n.details),console.error("[LeetLoop] Migration NOT marked complete due to error"),console.error("[LeetLoop] You can manually migrate by running SQL in Supabase:"),console.error("UPDATE submissions SET user_id = '".concat(o,"' WHERE user_id = '").concat(t,"';")),console.error("UPDATE skill_scores SET user_id = '".concat(o,"' WHERE user_id = '").concat(t,"';")),console.error("UPDATE review_queue SET user_id = '".concat(o,"' WHERE user_id = '").concat(t,"';"));return}if(!r||"object"!=typeof r){console.error("[LeetLoop] Migration returned unexpected data:",r),console.error("[LeetLoop] Migration NOT marked complete due to unexpected response");return}if(!0!==r.success){console.error("[LeetLoop] Migration returned success=false:",r),console.error("[LeetLoop] Migration NOT marked complete");return}console.log("[LeetLoop] Migration successful!"),console.log("[LeetLoop] Migrated counts:",r.migrated),localStorage.setItem("leetloop_migration_complete","true"),localStorage.setItem("leetloop_user_id",o),console.log("[LeetLoop] Updated local user ID to auth ID")}catch(e){console.error("[LeetLoop] Migration exception:",e),console.error("[LeetLoop] Migration NOT marked complete due to exception"),console.error("[LeetLoop] Guest UUID for manual migration:",t),console.error("[LeetLoop] Auth User ID for manual migration:",o)}}window.resetLeetLoopMigration=()=>{localStorage.removeItem("leetloop_migration_complete"),console.log("[LeetLoop] Migration flag cleared. Sign out and back in to retry migration.")},window.getLeetLoopMigrationInfo=()=>{console.log("[LeetLoop] Migration complete:",localStorage.getItem("leetloop_migration_complete")),console.log("[LeetLoop] Guest user ID:",localStorage.getItem("leetloop_user_id"))}},65095:function(e,o,t){"use strict";var r=t(17353);t.o(r,"usePathname")&&t.d(o,{usePathname:function(){return r.usePathname}}),t.o(r,"useRouter")&&t.d(o,{useRouter:function(){return r.useRouter}})},68273:function(e,o,t){"use strict";function r(){for(var e,o,t=0,r="",n=arguments.length;t<n;t++)(e=arguments[t])&&(o=function e(o){var t,r,n="";if("string"==typeof o||"number"==typeof o)n+=o;else if("object"==typeof o){if(Array.isArray(o)){var s=o.length;for(t=0;t<s;t++)o[t]&&(r=e(o[t]))&&(n&&(n+=" "),n+=r)}else for(r in o)o[r]&&(n&&(n+=" "),n+=r)}return n}(e))&&(r&&(r+=" "),r+=o);return r}t.d(o,{W:function(){return r}}),o.Z=r}},function(e){e.O(0,[453,980,852,999,744],function(){return e(e.s=52226)}),_N_E=e.O()}]);