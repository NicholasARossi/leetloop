"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[532],{92561:function(e,t,o){o.d(t,{v:function(){return g}});var r=o(89075),n=o(7596),a=o(93314),i=o(47086),s=o(64681),l=o(34386),c=o(18306),u=o(33936);function g(e){let{skills:t,className:o}=e,g=t.sort((e,t)=>t.total_attempts-e.total_attempts).slice(0,8).map(e=>({tag:e.tag.replace(/-/g," ").replace(/\b\w/g,e=>e.toUpperCase()),score:Math.round(e.score),fullMark:100}));return 0===g.length?(0,r.jsx)("div",{className:o,children:(0,r.jsx)("div",{className:"flex items-center justify-center h-64 text-slate-500",children:"No skill data yet. Start solving problems!"})}):(0,r.jsx)("div",{className:o,children:(0,r.jsx)(n.h,{width:"100%",height:300,children:(0,r.jsxs)(a.H,{cx:"50%",cy:"50%",outerRadius:"80%",data:g,children:[(0,r.jsx)(i.n,{stroke:"#e2e8f0"}),(0,r.jsx)(s.I,{dataKey:"tag",tick:{fill:"#64748b",fontSize:11}}),(0,r.jsx)(l.S,{angle:30,domain:[0,100],tick:{fill:"#94a3b8",fontSize:10}}),(0,r.jsx)(c.F,{name:"Skill Score",dataKey:"score",stroke:"#0ea5e9",fill:"#0ea5e9",fillOpacity:.3}),(0,r.jsx)(u.u,{formatter:e=>["".concat(e,"/100"),"Score"],contentStyle:{backgroundColor:"#1e293b",border:"none",borderRadius:"8px",color:"#f8fafc"}})]})})})}},19894:function(e,t,o){o.r(t),o.d(t,{AuthProvider:function(){return d},useAuth:function(){return m}});var r=o(89075),n=o(50511),a=o(52453);let i=null,s=async(e,t,o)=>await o(),l={SESSION_BRIDGE:"leetloop_session_bridge"},c={AUTH_CHANGE:"leetloop:auth-change",SIGNED_OUT:"leetloop:signed-out",GUEST_ID:"leetloop:guest-id"};function u(e){if(console.log("[LeetLoop Web] storeSessionBridge called, hasSession:",!!e),(null==e?void 0:e.access_token)&&(null==e?void 0:e.refresh_token)){let t={access_token:e.access_token,refresh_token:e.refresh_token};localStorage.setItem(l.SESSION_BRIDGE,JSON.stringify(t)),console.log("[LeetLoop Web] Session bridge stored in localStorage"),window.dispatchEvent(new CustomEvent(c.AUTH_CHANGE,{detail:t})),console.log("[LeetLoop Web] Dispatched auth-change event")}else localStorage.removeItem(l.SESSION_BRIDGE)}function g(){localStorage.removeItem(l.SESSION_BRIDGE),window.dispatchEvent(new CustomEvent(c.SIGNED_OUT))}let p=(0,n.createContext)(void 0);function d(e){let{children:t}=e,[o,l]=(0,n.useState)(null),[d,m]=(0,n.useState)(null),[S,L]=(0,n.useState)(!0),_=(0,n.useMemo)(()=>i||(i=(0,a.createBrowserClient)("https://ewezpbczwioxyflyffyy.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImV3ZXpwYmN6d2lveHlmbHlmZnl5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjkzMDI3MzAsImV4cCI6MjA4NDg3ODczMH0.XxVIJRRYNR_IdMhVN0gGMVYghb19Uyly4rbwxJJKDVg",{auth:{flowType:"pkce",detectSessionInUrl:!0,persistSession:!0,debug:!1,lock:s}})),[]),I=(null==o?void 0:o.id)||h();(0,n.useEffect)(()=>{let e=!0,t=null;(async()=>{try{let{data:{session:o}}=await _.auth.getSession();if(e){var t;m(o),l(null!==(t=null==o?void 0:o.user)&&void 0!==t?t:null),L(!1),u(o)}}catch(t){t instanceof Error&&"AbortError"===t.name?console.log("[LeetLoop] Ignoring AbortError in dev mode"):console.error("[LeetLoop] Error getting session:",t),e&&L(!1)}})();let o=h();o&&window.dispatchEvent(new CustomEvent(c.GUEST_ID,{detail:o}));try{let{data:o}=_.auth.onAuthStateChange(async(t,o)=>{if(e){var r;m(o),l(null!==(r=null==o?void 0:o.user)&&void 0!==r?r:null),L(!1),u(o),"SIGNED_IN"===t&&(null==o?void 0:o.user)&&await f(_,o.user.id),"SIGNED_OUT"===t&&g()}});t=o.subscription}catch(e){console.error("[LeetLoop] Error setting up auth listener:",e)}return()=>{e=!1,null==t||t.unsubscribe()}},[_]);let y=async(e,t)=>{let{error:o}=await _.auth.signInWithPassword({email:e,password:t});if(o)throw o},w=async(e,t)=>{let{error:o}=await _.auth.signUp({email:e,password:t});if(o)throw o},v=async()=>{let{error:e}=await _.auth.signInWithOAuth({provider:"google",options:{redirectTo:"".concat(window.location.origin,"/auth/callback")}});if(e)throw e},b=async()=>{let{error:e}=await _.auth.signOut();if(e)throw e;g()};return(0,r.jsx)(p.Provider,{value:{user:o,session:d,userId:I,loading:S,signIn:y,signUp:w,signInWithGoogle:v,signOut:b},children:t})}function m(){let e=(0,n.useContext)(p);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}function h(){let e=localStorage.getItem("leetloop_user_id");return e||(e=crypto.randomUUID(),localStorage.setItem("leetloop_user_id",e)),e}async function f(e,t){if("true"===localStorage.getItem("leetloop_migration_complete")){console.log("[LeetLoop] Migration already marked complete, skipping"),console.log('[LeetLoop] To retry migration, run: localStorage.removeItem("leetloop_migration_complete")');return}let o=localStorage.getItem("leetloop_user_id");if(!o){console.log("[LeetLoop] No guest user ID found, nothing to migrate"),localStorage.setItem("leetloop_migration_complete","true");return}if(o===t){console.log("[LeetLoop] Guest ID matches auth ID, no migration needed"),localStorage.setItem("leetloop_migration_complete","true");return}console.log("[LeetLoop] Starting migration..."),console.log("[LeetLoop] Guest UUID:",o),console.log("[LeetLoop] Auth User ID:",t);try{let{data:r,error:n}=await e.rpc("migrate_guest_to_auth",{p_guest_id:o,p_auth_id:t});if(n){console.error("[LeetLoop] Migration RPC error:",n),console.error("[LeetLoop] Error code:",n.code),console.error("[LeetLoop] Error message:",n.message),console.error("[LeetLoop] Error details:",n.details),console.error("[LeetLoop] Migration NOT marked complete due to error"),console.error("[LeetLoop] You can manually migrate by running SQL in Supabase:"),console.error("UPDATE submissions SET user_id = '".concat(t,"' WHERE user_id = '").concat(o,"';")),console.error("UPDATE skill_scores SET user_id = '".concat(t,"' WHERE user_id = '").concat(o,"';")),console.error("UPDATE review_queue SET user_id = '".concat(t,"' WHERE user_id = '").concat(o,"';"));return}if(!r||"object"!=typeof r){console.error("[LeetLoop] Migration returned unexpected data:",r),console.error("[LeetLoop] Migration NOT marked complete due to unexpected response");return}if(!0!==r.success){console.error("[LeetLoop] Migration returned success=false:",r),console.error("[LeetLoop] Migration NOT marked complete");return}console.log("[LeetLoop] Migration successful!"),console.log("[LeetLoop] Migrated counts:",r.migrated),localStorage.setItem("leetloop_migration_complete","true"),localStorage.setItem("leetloop_user_id",t),console.log("[LeetLoop] Updated local user ID to auth ID")}catch(e){console.error("[LeetLoop] Migration exception:",e),console.error("[LeetLoop] Migration NOT marked complete due to exception"),console.error("[LeetLoop] Guest UUID for manual migration:",o),console.error("[LeetLoop] Auth User ID for manual migration:",t)}}window.resetLeetLoopMigration=()=>{localStorage.removeItem("leetloop_migration_complete"),console.log("[LeetLoop] Migration flag cleared. Sign out and back in to retry migration.")},window.getLeetLoopMigrationInfo=()=>{console.log("[LeetLoop] Migration complete:",localStorage.getItem("leetloop_migration_complete")),console.log("[LeetLoop] Guest user ID:",localStorage.getItem("leetloop_user_id"))}},24637:function(e,t,o){o.d(t,{K:function(){return i}});class r extends Error{constructor(e,t){super(t),this.status=e,this.name="ApiError"}}async function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{timeout:o=3e4,...r}=t,n=new AbortController,a=setTimeout(()=>n.abort(),o);try{return await fetch(e,{...r,signal:n.signal})}finally{clearTimeout(a)}}async function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o="".concat("http://localhost:8081").concat(e),a=await n(o,{headers:{"Content-Type":"application/json",...t.headers},...t});if(!a.ok){let e=await a.json().catch(()=>({detail:"Unknown error"}));throw new r(a.status,e.detail||a.statusText)}return a.json()}let i={health:()=>a("/health"),getProgress:e=>a("/api/progress/".concat(e)),getStats:e=>a("/api/progress/".concat(e,"/stats")),getSkillScores:e=>a("/api/progress/".concat(e,"/skills")),getSubmissions:(e,t)=>{let o=new URLSearchParams;(null==t?void 0:t.limit)&&o.set("limit",t.limit.toString()),(null==t?void 0:t.offset)&&o.set("offset",t.offset.toString()),(null==t?void 0:t.status)&&o.set("status",t.status),(null==t?void 0:t.difficulty)&&o.set("difficulty",t.difficulty),(null==t?void 0:t.tag)&&o.set("tag",t.tag);let r=o.toString();return a("/api/submissions/".concat(e).concat(r?"?".concat(r):""))},getRecommendations:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return a("/api/recommendations/".concat(e,"?limit=").concat(t))},getNextProblem:e=>a("/api/recommendations/".concat(e,"/next")),getReviews:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return a("/api/reviews/".concat(e,"?limit=").concat(t))},getReviewCount:e=>a("/api/reviews/".concat(e,"/count")),completeReview:(e,t)=>a("/api/reviews/".concat(e,"/complete"),{method:"POST",body:JSON.stringify({success:t})}),chat:function(e,t,o){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return a("/api/coaching/chat",{method:"POST",body:JSON.stringify({user_id:e,message:t,context:o,history:r})})},analyzeCode:(e,t,o,r,n,i)=>a("/api/coaching/analyze",{method:"POST",body:JSON.stringify({user_id:e,submission_id:t,code:o,language:r,problem_slug:n,status:i})}),getTips:e=>a("/api/coaching/tips/".concat(e)),getPaths:()=>a("/api/paths"),getPath:e=>a("/api/paths/".concat(e)),getPathProgress:(e,t)=>a("/api/paths/".concat(e,"/progress/").concat(t)),completeProblem:(e,t,o)=>a("/api/paths/".concat(e,"/complete/").concat(t),{method:"POST",body:JSON.stringify({problem_slug:o})}),setCurrentPath:(e,t)=>a("/api/users/".concat(e,"/current-path"),{method:"PUT",body:JSON.stringify({path_id:t})}),getCurrentPath:e=>a("/api/users/".concat(e,"/current-path")),getTodaysFocus:e=>a("/api/today/".concat(e)),getMastery:e=>a("/api/mastery/".concat(e)),getDomainDetail:(e,t)=>a("/api/mastery/".concat(e,"/").concat(encodeURIComponent(t)))}}}]);